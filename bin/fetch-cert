#!/bin/bash

function usage() {
    echo "Usage: $(basename "$0") DOMAIN [CONNECT]" >&2
}

domain=$1
if [[ -z "$domain" ]]; then
    usage
    exit 2
fi
connect=${2:-$domain}
if [[ -z "$connect" ]]; then
    usage
    exit 2
fi

# Original source: https://serverfault.com/a/661982
echo | \
    openssl s_client \
        -showcerts \
        -servername "$domain" \
        -connect "$connect":443 \
        2>/dev/null | \
    openssl x509 -inform pem -noout -text
